/***********************************************************
 * 版权信息: 李华锋同学，保留一切权利
 * 文件名称: tree.c
 * 文件作者: lihf
 * 完成日期: 2018-11-03
 * 当前版本:
 * 主要功能: 将配置字符串("xxx->xxx->xxx=y")转换为树形的数据链表，来存储
 * 版本历史:
 ***********************************************************/

/********************************************************************************************************
 *                                        File Include                                                  *
 ********************************************************************************************************/
#include <stdio.h>

#include "typedef.h"
#include "list.h"

/********************************************************************************************************
 *                                        Defines                                                       *
 ********************************************************************************************************/


/********************************************************************************************************
 *                                        Global Variables                                              *
 ********************************************************************************************************/


/********************************************************************************************************
 *                                        Local Variables                                               *
 ********************************************************************************************************/


/********************************************************************************************************
 *                                        Local Functions Declaring                                     *
 ********************************************************************************************************/
//static s_tree_root_t tree_root = NOTE_ROOT_INIT(tree_root);

/********************************************************************************************************
 *                                        Local Functions                                               *
 ********************************************************************************************************/

/***********************************************************
 * 函数名称：name_list_find_next
 * 功能描述：寻找name_list字符串下个节点的位置
 * 输入参数：
 *           name_list 名字串中地址
 * 输出参数：无
 * 返 回 值：如果存在，则返回下个节点的地址，否则返回NULL
 ***********************************************************/
static const u8 *name_list_find_next(const u8 *name_list)
{
    const u8 *ptmp = name_list;

    while('\0' != *ptmp)
    {
        ptmp++;

        if( ('-' == *ptmp) && ('>' == *(ptmp+1)) && ('\0' != *(ptmp+2)) )
        {
            return ptmp+2;
        }
    }

    return NULL;
}

/********************************************************************************************************
 *                                        Global Functions                                              *
 ********************************************************************************************************/
/***********************************************************
 * 函数名称：tree_add
 * 功能描述：将name_list表示的配置项和节点，添加到树链表中
 * 输入参数：name_list  字符串形式("xxx->xxx->xxx")，表示的父节点和子节点之间的关系
             value      末尾节点的值，字符串表示
             value_len  字符串值的长度
 * 输出参数：无
 * 返 回 值：NO_ERROR
             ERROR
 ***********************************************************/
int tree_add(const u8 *name_list, const void *value, const int value_len)
{
    const u8 *pnext = NULL;

    printf("name_list: %s\n", name_list);

    while(1)
    {
        pnext = name_list_find_next(name_list);
        if( NULL != pnext )
        {
            printf("name list left: %s\n", pnext);
        }
        else
        {
            printf("find over!\n");
            break;
        }

        name_list = pnext;
    }

    return NO_ERROR;
}

